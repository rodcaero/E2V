---
import { Image } from 'astro:assets';
import e2vLogo from '../assets/E2V.png';

interface NavItem {
  name: string;
  href: string;
  highlight?: boolean;
}

const navItems: NavItem[] = [
  { name: 'Inicio', href: '/' },
  { name: 'Quiénes somos', href: '/quienes-somos' },
  { name: 'Noticias', href: '/noticias' },
  { name: 'Contacto', href: '/contacto' },
  { name: '⚡ ElectroPoint', href: '/', highlight: true }, // Resaltado
];
---

<div class="header-top-bar"></div>

<header class="header">
  <div class="nav-container">
    <a href="/" class="logo">
      <Image src={e2vLogo} alt="E2V Logo" class="header-logo" quality="high"/>
    </a>

    <nav id="menu" class="nav-links">
      <div class="tech-grid-bg mobile-bg"></div>
      
      <div class="links-wrapper">
        {navItems.map((item, index) => (
          <a 
            href={item.href} 
            class={item.highlight ? 'btn-highlight' : 'regular-link'} 
            style={`--i: ${index}`}
          >
            {item.name}
          </a>
        ))}
      </div>
    </nav>

    <button id="btn-toggle" class="btn-toggle" aria-label="Menú">
      <span></span><span></span><span></span>
    </button>
  </div>
</header>

<script>
  function setupMenu() {
    const btn = document.getElementById('btn-toggle');
    const menu = document.getElementById('menu');

    if (btn && menu) {
      btn.onclick = null; 
      
      btn.onclick = () => {
        const isShowing = menu.classList.toggle('show');
        btn.classList.toggle('open');
        document.body.style.overflow = isShowing ? 'hidden' : 'auto';
      };

      const links = menu.querySelectorAll('a');
      links.forEach(link => {
        link.onclick = () => {
          menu.classList.remove('show');
          btn.classList.remove('open');
          document.body.style.overflow = 'auto';
        };
      });
    }
  }

  setupMenu();
  document.addEventListener('astro:page-load', setupMenu);
</script>

<style>
  /* --- Adorno Superior --- */
  .header-top-bar {
    height: 4px;
    width: 100%;
    background: linear-gradient(90deg, var(--brand-800) 0%, var(--cta-main) 50%, var(--brand-800) 100%);
    position: fixed;
    top: 0;
    z-index: 10000;
  }

  /* --- Base del Header --- */
  .header {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px); /* Efecto cristal moderno */
    border-bottom: 1px solid var(--brand-200);
    position: sticky;
    top: 4px; /* Empuja el header debajo de la barra superior */
    z-index: 9999;
    height: 80px;
    display: flex;
    align-items: center;
    font-family: var(--font-main);
    box-shadow: 0 4px 20px rgba(0,0,0,0.02);
  }

  .nav-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 90%;
    max-width: 1200px;
    margin: auto;
    height: 100%;
  }

  /* --- Logo --- */
  .logo { display: flex; align-items: center; height: 100%; }
  .header-logo { height: 60px; width: auto; display: block; }

  /* --- Enlaces y Wrapper --- */
  .links-wrapper { 
    display: flex; 
    gap: 2rem; 
    align-items: center; 
    height: 100%;
    position: relative;
    z-index: 2;
  }

  .nav-links a {
    text-decoration: none;
    font-weight: 700;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-family: var(--font-main);
    transition: all 0.3s ease;
    display: flex; 
    align-items: center;
  }

  /* --- Links Regulares (Efecto Subrayado Técnico) --- */
  .regular-link {
    color: var(--brand-800);
    position: relative;
    padding: 5px 0;
  }

  .regular-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0%;
    height: 2px;
    background-color: var(--cta-main);
    transition: width 0.3s ease;
  }

  .regular-link:hover { color: var(--cta-main); }
  .regular-link:hover::after { width: 100%; }

  


  .mobile-bg { display: none; }
  .btn-toggle { display: none; }

  /* --- RESPONSIVE MÓVIL --- */
  @media (max-width: 1024px) {
    .btn-toggle { display: flex; flex-direction: column; gap: 6px; background: none; border: none; cursor: pointer; z-index: 10001; padding: 10px; }
    .btn-toggle span { width: 28px; height: 3px; background: var(--brand-800); transition: 0.3s; border-radius: 2px; }
    .btn-toggle.open span:nth-child(1) { transform: rotate(45deg) translate(6px, 6px); }
    .btn-toggle.open span:nth-child(2) { opacity: 0; }
    .btn-toggle.open span:nth-child(3) { transform: rotate(-45deg) translate(7px, -7px); }

    .nav-links {
      position: fixed;
      top: 0;
      right: -100%;
      width: 100%;
      height: 100vh;
      background: var(--white);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: 0.4s cubic-bezier(0.77, 0, 0.175, 1); /* Animación más suave */
      z-index: 10000;
    }

    .nav-links.show { right: 0; }
    
   
    .links-wrapper { flex-direction: column; gap: 2.5rem; justify-content: center; }
    
    .regular-link { font-size: 1.5rem; }
    
    
  }
</style>